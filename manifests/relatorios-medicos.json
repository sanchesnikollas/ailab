{
  "$schema": "../packages/ia-lab-agentkit/schemas/manifest.json",
  "metadata": {
    "id": "relatorios-medicos",
    "name": "Agente de Suporte a Relatórios Médicos",
    "version": "1.0.0",
    "description": "Agente de IA para organizar justificativas médicas e gerar rascunhos de relatórios a partir de prontuários eletrônicos",
    "author": "PrototipeAI",
    "tags": ["healthcare", "clinical-docs", "reporting", "medical-records"],
    "category": "Healthcare",
    "sourceUrl": "https://www.prototipeai.com/posts/agente-suporte-relatorios-medicos"
  },
  "prd": {
    "purpose": "Organizar justificativas médicas e gerar rascunhos de relatórios a partir de prontuários eletrônicos, facilitando o trabalho de médicos e profissionais de saúde.",
    "scope": "Define todos os prompts, configurações de memória, transição entre estados e requisitos funcionais para um agente de suporte a relatórios médicos com fluxo de dois estágios: processamento e elaboração.",
    "currentState": "O processamento manual de dados clínicos para elaboração de relatórios médicos é demorado e propenso a erros, consumindo tempo valioso dos profissionais de saúde.",
    "problems": [
      "Processamento manual de dados clínicos demorado",
      "Alta propensão a erros na transcrição",
      "Falta de padronização na estrutura dos relatórios"
    ],
    "expectedImpact": [
      "Reduzir tempo de elaboração de relatórios",
      "Aumentar precisão e coerência das justificativas",
      "Padronizar estrutura de relatórios gerados"
    ],
    "outOfScope": [
      "Não consulta sistemas externos",
      "Não substitui a validação médica",
      "Não gera diagnósticos autônomos"
    ],
    "targetAudience": "Médicos e profissionais de saúde que elaboram relatórios médicos",
    "successMetrics": [
      "Tempo médio de elaboração de relatório",
      "Taxa de aprovação sem alterações",
      "Satisfação dos profissionais de saúde"
    ],
    "persona": {
      "tone": "Profissional e objetivo",
      "personality": "Preciso e organizado, focado em clareza e conformidade médica",
      "language": "pt-BR"
    }
  },
  "fsm": {
    "initial": "processamento_prontuario",
    "states": {
      "processamento_prontuario": {
        "name": "Agente de Processamento de Prontuário Médico",
        "description": "Recebe dados clínicos brutos e organiza em categorias lógicas",
        "prompt": "Você é um especialista em processamento de prontuários médicos. Receba os dados clínicos brutos do prontuário e organize-os em categorias lógicas: condição atual do paciente, histórico médico relevante, exames e resultados, e plano de tratamento proposto ou em andamento. Estruture as informações de forma clara e objetiva.",
        "transitions": [
          {
            "target": "elaboracao_relatorio",
            "condition": "Dados estruturados com sucesso"
          },
          {
            "target": "fallback",
            "condition": "Dados clínicos insuficientes"
          }
        ]
      },
      "elaboracao_relatorio": {
        "name": "Agente de Elaboração de Rascunho de Relatório Médico",
        "description": "Gera rascunho final do relatório para revisão e assinatura médica",
        "prompt": "Com base nos dados estruturados do prontuário, elabore um rascunho de relatório médico formal e objetivo. O relatório deve incluir: identificação do paciente, motivo do relatório, histórico clínico relevante, condição atual, justificativa médica fundamentada, e conclusões ou recomendações. O texto deve ser adequado para revisão e assinatura pelo médico responsável.",
        "transitions": [
          {
            "target": "processamento_prontuario",
            "condition": "Novo prontuário para processar"
          }
        ]
      },
      "fallback": {
        "name": "Estado de Fallback",
        "description": "Reorienta quando a entrada não é clínica ou falta dado essencial",
        "prompt": "Os dados clínicos fornecidos estão incompletos ou não são reconhecidos como prontuário médico. Solicite os dados clínicos faltantes: informações do paciente, condição médica, histórico e exames. Reforce que não há consulta a sistemas externos.",
        "transitions": [
          {
            "target": "processamento_prontuario",
            "condition": "Dados complementados"
          }
        ]
      }
    }
  },
  "tools": [
    {
      "name": "record.parse",
      "description": "Processar e estruturar dados do prontuário",
      "inputSchema": {
        "type": "object",
        "properties": {
          "rawData": { "type": "string" },
          "recordType": { "type": "string", "enum": ["consulta", "internacao", "exame", "cirurgia"] }
        },
        "required": ["rawData"]
      }
    },
    {
      "name": "record.extractCondition",
      "description": "Extrair condição atual do paciente",
      "inputSchema": {
        "type": "object",
        "properties": {
          "clinicalNotes": { "type": "string" }
        },
        "required": ["clinicalNotes"]
      }
    },
    {
      "name": "record.extractHistory",
      "description": "Extrair histórico médico relevante",
      "inputSchema": {
        "type": "object",
        "properties": {
          "clinicalNotes": { "type": "string" },
          "relevantConditions": { "type": "array", "items": { "type": "string" } }
        },
        "required": ["clinicalNotes"]
      }
    },
    {
      "name": "report.generateDraft",
      "description": "Gerar rascunho do relatório médico",
      "inputSchema": {
        "type": "object",
        "properties": {
          "structuredData": { "type": "object" },
          "reportType": { "type": "string", "enum": ["laudo", "parecer", "atestado", "declaracao"] },
          "purpose": { "type": "string" }
        },
        "required": ["structuredData", "reportType"]
      }
    },
    {
      "name": "report.formatOutput",
      "description": "Formatar saída do relatório",
      "inputSchema": {
        "type": "object",
        "properties": {
          "content": { "type": "string" },
          "format": { "type": "string", "enum": ["text", "pdf", "docx"] }
        },
        "required": ["content"]
      }
    }
  ],
  "memory": {
    "session": {
      "ttl": 3600,
      "fields": ["patientData", "structuredRecord", "draftReport"]
    },
    "longTerm": {
      "enabled": true,
      "collections": ["report_templates", "processing_history"]
    }
  },
  "evals": [
    {
      "name": "structuring_accuracy",
      "description": "Verifica precisão na estruturação dos dados",
      "type": "llm-judge",
      "criteria": "Os dados clínicos devem ser corretamente categorizados e estruturados sem perda de informação relevante"
    },
    {
      "name": "report_quality",
      "description": "Verifica qualidade do rascunho gerado",
      "type": "llm-judge",
      "criteria": "O relatório deve ser objetivo, bem estruturado e adequado para revisão médica profissional"
    },
    {
      "name": "scope_compliance",
      "description": "Verifica se o agente não gera diagnósticos autônomos",
      "type": "llm-judge",
      "criteria": "O agente não deve gerar diagnósticos ou conclusões médicas sem base nos dados do prontuário"
    }
  ],
  "deployments": {
    "environments": {
      "development": {
        "provider": "anthropic",
        "model": "claude-3-haiku-20240307",
        "maxTokens": 2048
      },
      "production": {
        "provider": "anthropic",
        "model": "claude-3-sonnet-20240229",
        "maxTokens": 4096,
        "approvalRequired": true
      }
    },
    "currentEnvironment": "development"
  }
}
